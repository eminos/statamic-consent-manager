function i(s,e,t,a,r,h,m,v){var n=typeof s=="function"?s.options:s;return e&&(n.render=e,n.staticRenderFns=t,n._compiled=!0),{exports:s,options:n}}const o={props:{title:String,action:String,blueprint:Object,meta:Object,values:Object},data(){return{currentValues:this.values,currentMeta:this.meta,saving:!1,errors:{},hasSidebar:this.blueprint.tabs.map(s=>s.handle).includes("sidebar")}},watch:{values(s){this.currentValues=s},meta(s){this.currentMeta=s}},methods:{clearErrors(){this.errors={}},saveWithReconsent(){this.performSave(!0)},saveNormal(){this.performSave(!1)},performSave(s){this.saving=!0,this.clearErrors();const e={...this.currentValues,require_reconsent:s};this.$axios.patch(this.action,e).then(t=>{this.saving=!1,this.$toast.success(t.data.message||__("Saved")),this.$refs.container.saved(),this.$emit("saved",t)}).catch(t=>{if(this.saving=!1,t.response&&t.response.status===422){const{message:a,errors:r}=t.response.data;this.errors=r||{},this.$toast.error(a||__("Validation failed. Please check the form."))}else{const a=t.response?.data?.message;this.$toast.error(a||__("Something went wrong"))}})}},created(){this.$keys.bindGlobal(["mod+s"],s=>{s.preventDefault(),this.saveNormal()})}};var c=function(){var e=this,t=e._self._c;return t("publish-container",{ref:"container",attrs:{name:"base",blueprint:e.blueprint,reference:"collection",meta:e.currentMeta,errors:e.errors},scopedSlots:e._u([{key:"default",fn:function({setFieldValue:a,setFieldMeta:r}){return[t("div",[t("div",{staticClass:"flex items-center mb-6"},[t("h1",{staticClass:"flex-1"},[e._v(e._s(e.title))]),t("div",{staticClass:"btn-group"},[t("button",{staticClass:"btn",attrs:{disabled:e.saving},on:{click:e.saveWithReconsent}},[e._v(" "+e._s(e.__("Save & Require Re-consent"))+" ")]),t("button",{staticClass:"btn-primary",attrs:{disabled:e.saving},on:{click:e.saveNormal}},[e._v(" "+e._s(e.__("Save"))+" ")])])]),t("publish-tabs",{attrs:{"enable-sidebar":e.hasSidebar,"read-only":!1},on:{updated:a,"meta-updated":r}})],1)]}}]),model:{value:e.currentValues,callback:function(a){e.currentValues=a},expression:"currentValues"}})},l=[],u=i(o,c,l);const d=u.exports;Statamic.booting(()=>{Statamic.$components.register("consent-manager-publish-form",d)});

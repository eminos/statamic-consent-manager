class s{constructor(e){this.consentManager=e,this.config=null,this.lastStateSerialized=null}getName(){return"google_tag"}loadConfig(e){this.config=e.google_tag||null}isEnabled(){return!!(this.config&&this.config.enabled&&this.config.measurement_id)}computeState(){if(!this.isEnabled())return null;const e={ad_storage:"denied",ad_user_data:"denied",ad_personalization:"denied",analytics_storage:"denied",functionality_storage:"denied",personalization_storage:"denied",security_storage:"granted"},t=this.config.service_mapping||{};return Object.entries(t).forEach(([n,a])=>{if(!Array.isArray(a))return;const r=this.consentManager.getServiceConsent(n)?"granted":"denied";a.forEach(i=>{i&&(e[i]=r)})}),e}applyConsentUpdate(){if(!this.isEnabled())return;window.dataLayer=window.dataLayer||[],typeof window.gtag!="function"&&(window.gtag=function(){window.dataLayer.push(arguments)});const e=this.computeState();if(!e)return;const t=JSON.stringify(e);t!==this.lastStateSerialized&&(this.lastStateSerialized=t,window.gtag("consent","update",e))}getState(){return this.isEnabled()?{measurement_id:this.config.measurement_id,state:this.computeState()}:null}}document.addEventListener("DOMContentLoaded",()=>{window.consentManager&&window.consentManager.registerIntegration(new s(window.consentManager))});
